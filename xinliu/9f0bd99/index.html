<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="“Content-Security-Policy”" content="“upgrade-insecure-requests”/"><title>设置popupWindow显示位置以及点击其他位置取消弹出 | 农民艺术家</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="author" content="earl"><meta name="description" content="一、什么是WebViewAndroid 中的WebView（网络视图），可以这么去理解，就是一个内置的浏览器。它使用了WebKit渲染引擎加载显示网页。二、WebView的使用方式1. 实例化一个WebView2. 调用WebView的loadUrl()方法，设置WevView要显示的网页：互联网用：webView.loadUrl(“http://www.baidu.com“);本地文件用：web"><meta property="og:type" content="article"><meta property="og:title" content="设置popupWindow显示位置以及点击其他位置取消弹出"><meta property="og:url" content="http://xinliu.vip/xinliu/9f0bd99/index.html"><meta property="og:site_name" content="农民艺术家"><meta property="og:description" content="一、什么是WebViewAndroid 中的WebView（网络视图），可以这么去理解，就是一个内置的浏览器。它使用了WebKit渲染引擎加载显示网页。二、WebView的使用方式1. 实例化一个WebView2. 调用WebView的loadUrl()方法，设置WevView要显示的网页：互联网用：webView.loadUrl(“http://www.baidu.com“);本地文件用：web"><meta property="og:updated_time" content="2018-03-30T14:45:29.766Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="设置popupWindow显示位置以及点击其他位置取消弹出"><meta name="twitter:description" content="一、什么是WebViewAndroid 中的WebView（网络视图），可以这么去理解，就是一个内置的浏览器。它使用了WebKit渲染引擎加载显示网页。二、WebView的使用方式1. 实例化一个WebView2. 调用WebView的loadUrl()方法，设置WevView要显示的网页：互联网用：webView.loadUrl(“http://www.baidu.com“);本地文件用：web"><link rel="alternative" href="/atom.xml" title="农民艺术家" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="apple-touch-icon" href="/img/jacman.jpg"><link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg"><link rel="stylesheet" href="/css/style.css"></head></html><body><header><div><div id="imglogo"><a href="/"><img src="/img/logo.png" alt="农民艺术家" title="农民艺术家"></a></div><div id="textlogo"><h1 class="site-name"><a href="/" title="农民艺术家">农民艺术家</a></h1><h2 class="blog-motto">Keep Calm and Carry On</h2></div><div class="navbar"><a class="navbutton navmobile" href="#" title="菜单"></a></div><nav class="animated"><ul><ul><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">简介</a></li><li></li></ul></ul></nav></div></header><div id="container"><div id="main" class="post" itemscope itemprop="blogPost"><article itemprop="articleBody"><header class="article-info clearfix"><h1 itemprop="name"><a href="/xinliu/9f0bd99/" title="设置popupWindow显示位置以及点击其他位置取消弹出" itemprop="url">设置popupWindow显示位置以及点击其他位置取消弹出</a></h1><p class="article-author">By <a href="/about" title="earl" target="_blank" itemprop="author">earl</a></p><p class="article-time"><span class="head-plus">阅读<i class="fa fa-user"></i><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>次, </span><span class="head-plus"><i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="xinliu/9f0bd99/"><i class="fa fa-spinner fa-spin"></i></span> </span><time datetime="2018-01-18T06:35:55.000Z" itemprop="datePublished">发表于 2018-01-18</time></p></header><div class="article-content"><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、什么是WebView"><span class="toc-number">1.</span> <span class="toc-text">一、什么是WebView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、WebView的使用方式"><span class="toc-number">2.</span> <span class="toc-text">二、WebView的使用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-实例化一个WebView"><span class="toc-number">2.1.</span> <span class="toc-text">1. 实例化一个WebView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-调用WebView的loadUrl-方法，设置WevView要显示的网页："><span class="toc-number">2.2.</span> <span class="toc-text">2. 调用WebView的loadUrl()方法，设置WevView要显示的网页：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-需要在AndroidManifest-xml文件中添加权限，否则会出现Web-page-not-available错误"><span class="toc-number">2.3.</span> <span class="toc-text">3. 需要在AndroidManifest.xml文件中添加权限，否则会出现Web page not available错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-不同的使用方法"><span class="toc-number">2.4.</span> <span class="toc-text">4. 不同的使用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-webview的关闭"><span class="toc-number">2.5.</span> <span class="toc-text">5. webview的关闭</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、webview的参数设置"><span class="toc-number">3.</span> <span class="toc-text">三、webview的参数设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、WebViewClient的使用"><span class="toc-number">4.</span> <span class="toc-text">四、WebViewClient的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、WebChromeClient的使用"><span class="toc-number">5.</span> <span class="toc-text">五、WebChromeClient的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六、一些使用的小技巧"><span class="toc-number">6.</span> <span class="toc-text">六、一些使用的小技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-打开Android本地文件。"><span class="toc-number">6.1.</span> <span class="toc-text">1.打开Android本地文件。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-浏览网页的回退"><span class="toc-number">6.2.</span> <span class="toc-text">2.浏览网页的回退</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Android中Java代码和网页中js代码的交互"><span class="toc-number">6.3.</span> <span class="toc-text">3.Android中Java代码和网页中js代码的交互</span></a></li></ol></li></ol></div><h3 id="一、什么是WebView"><a href="#一、什么是WebView" class="headerlink" title="一、什么是WebView"></a><strong>一、什么是WebView</strong></h3><p>Android 中的WebView（网络视图），可以这么去理解，就是一个内置的浏览器。它使用了WebKit渲染引擎加载显示网页。</p><h3 id="二、WebView的使用方式"><a href="#二、WebView的使用方式" class="headerlink" title="二、WebView的使用方式"></a><strong>二、WebView的使用方式</strong></h3><h4 id="1-实例化一个WebView"><a href="#1-实例化一个WebView" class="headerlink" title="1. 实例化一个WebView"></a>1. 实例化一个WebView</h4><h4 id="2-调用WebView的loadUrl-方法，设置WevView要显示的网页："><a href="#2-调用WebView的loadUrl-方法，设置WevView要显示的网页：" class="headerlink" title="2. 调用WebView的loadUrl()方法，设置WevView要显示的网页："></a>2. 调用WebView的loadUrl()方法，设置WevView要显示的网页：</h4><p>互联网用：webView.loadUrl(“<a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a>“);<br>本地文件用：webView.loadUrl(“file:///android_asset/XX.html”); 此本地文件存放于assets 文件中</p><h4 id="3-需要在AndroidManifest-xml文件中添加权限，否则会出现Web-page-not-available错误"><a href="#3-需要在AndroidManifest-xml文件中添加权限，否则会出现Web-page-not-available错误" class="headerlink" title="3. 需要在AndroidManifest.xml文件中添加权限，否则会出现Web page not available错误"></a>3. 需要在AndroidManifest.xml文件中添加权限，否则会出现Web page not available错误</h4><pre><code>&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; &gt;&lt;/uses&gt; 
</code></pre><p>下面是简单的示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">import android.app.Activity;    </div><div class="line">   import android.os.Bundle;    </div><div class="line">   import android.view.KeyEvent;    </div><div class="line">   import android.webkit.WebView;    </div><div class="line">      </div><div class="line">   public class MainActivity extends Activity &#123;    </div><div class="line">       private WebView webview;    </div><div class="line">       @Override   </div><div class="line">       public void onCreate(Bundle savedInstanceState) &#123;    </div><div class="line">           super.onCreate(savedInstanceState);    </div><div class="line">           //实例化WebView对象    </div><div class="line">           webview = new WebView(this);    </div><div class="line">           //加载需要显示的网页    </div><div class="line">           webview.loadUrl("http://www.baidu.com/");    </div><div class="line">           //将Web视图作为activity的视图    </div><div class="line">           setContentView(webview);    </div><div class="line">       &#125;    </div><div class="line">         </div><div class="line">   &#125;</div></pre></td></tr></table></figure><h4 id="4-不同的使用方法"><a href="#4-不同的使用方法" class="headerlink" title="4. 不同的使用方法"></a>4. 不同的使用方法</h4><p>上面的示例代码，我们讲解了直接webview视图直接作为activity的视图，在实际项目当中，我们经常是需要将webview作为一部分嵌入到activity的视图中的。如果想这么做，我们需要先在布局文件中声明WebView。<br>下面是示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">import android.app.Activity;    </div><div class="line">import android.os.Bundle;    </div><div class="line">import android.view.KeyEvent;    </div><div class="line">import android.webkit.WebView;    </div><div class="line">import android.webkit.WebViewClient;    </div><div class="line">   </div><div class="line">public class MainActivity extends Activity &#123;    </div><div class="line">    private WebView webview;    </div><div class="line">    @Override   </div><div class="line">    public void onCreate(Bundle savedInstanceState) &#123;    </div><div class="line">        super.onCreate(savedInstanceState);    </div><div class="line">        setContentView(R.layout.main);    </div><div class="line">        webview = (WebView) findViewById(R.id.webview);    </div><div class="line">        //加载需要显示的网页    </div><div class="line">        webview.loadUrl("http://www.baidu.com/");    </div><div class="line">    &#125;    </div><div class="line">     </div><div class="line">&#125;</div></pre></td></tr></table></figure><p>xml示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;   </div><div class="line">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"   </div><div class="line">    android:orientation="vertical"   </div><div class="line">    android:layout_width="fill_parent"   </div><div class="line">    android:layout_height="fill_parent"   </div><div class="line">    &gt;      </div><div class="line">    &lt;WebView     </div><div class="line">        android:id="@+id/webview"   </div><div class="line">        android:layout_width="fill_parent"   </div><div class="line">        android:layout_height="fill_parent"   </div><div class="line">        /&gt;   </div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure><h4 id="5-webview的关闭"><a href="#5-webview的关闭" class="headerlink" title="5. webview的关闭"></a>5. webview的关闭</h4><p>当我们在使用有声音播放的webview，我们如果直接finish掉webview做依赖的activity，我们会发现webview的声音播放还未停止，这是因为activity虽然被finish掉了，但是webview实际并未被销毁掉。<br>我们需要调用webview的destroy方法销毁webview。<br>下面是示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//webview的销毁  </div><div class="line">public void stop() &#123;  </div><div class="line">        web_view.destroy();  </div><div class="line">        ((Activity) getContext()).finish();  </div><div class="line">    &#125;</div></pre></td></tr></table></figure><h3 id="三、webview的参数设置"><a href="#三、webview的参数设置" class="headerlink" title="三、webview的参数设置"></a><strong>三、webview的参数设置</strong></h3><p>webview的参数有很多，下面我们直接上一段示例代码进行说明:</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//设置支持js代码  </div><div class="line">        web_view.getSettings().setJavaScriptEnabled(true);  </div><div class="line">        //设置支持插件  </div><div class="line">        web_view.getSettings().setPluginState(PluginState.ON);  </div><div class="line">        //设置允许访问文件数据  </div><div class="line">        web_view.getSettings().setAllowFileAccess(true);  </div><div class="line">        //设置是否支持插件  </div><div class="line">        web_view.getSettings().setPluginsEnabled(true);  </div><div class="line">        //支持缩放  </div><div class="line">        web_view.getSettings().setSupportZoom(true);  </div><div class="line">        //支持缓存  </div><div class="line">        web_view.getSettings().setAppCacheEnabled(true);  </div><div class="line">        //设置缓存模式  </div><div class="line">        web_view.getSettings().setCacheMode(WebSettings.LOAD_CACHE_ELSE_NETWORK);  </div><div class="line">        //设置此属性，可任意比例缩放  </div><div class="line">        web_view.getSettings().setUseWideViewPort(true);  </div><div class="line">        web_view.getSettings().setLoadWithOverviewMode(true);</div></pre></td></tr></table></figure><h3 id="四、WebViewClient的使用"><a href="#四、WebViewClient的使用" class="headerlink" title="四、WebViewClient的使用"></a><strong>四、WebViewClient的使用</strong></h3><p>WebViewClient主要帮助WebView处理各种通知、请求事件的。比如：<br>onLoadResource<br>onPageStart<br>onPageFinish<br>onReceiveError<br>onReceivedHttpAuthRequest<br>例如以下示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">webView.setWebViewClient(new WebViewClient()&#123;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                        public void onLoadResource(WebView view, String url) &#123;  </div><div class="line">                                super.onLoadResource(view, url);  </div><div class="line">                                Log.i(TAG, "onLoadResource: ");  </div><div class="line">                        &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                        public void onPageFinished(WebView view, String url) &#123;  </div><div class="line">                                super.onPageFinished(view, url);  </div><div class="line">                                Log.i(TAG, "onPageFinished: ");  </div><div class="line">                        &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                        public void onPageStarted(WebView view, String url, Bitmap favicon) &#123;  </div><div class="line">                                super.onPageStarted(view, url, favicon);  </div><div class="line">                                Log.i(TAG, "onPageStarted: ");  </div><div class="line">                        &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                        public void onReceivedHttpAuthRequest(WebView view,  </div><div class="line">                                        HttpAuthHandler handler, String host, String realm) &#123;  </div><div class="line">                                super.onReceivedHttpAuthRequest(view, handler, host, realm);  </div><div class="line">                                Log.i(TAG, "onReceivedHttpAuthRequest: ");  </div><div class="line">                        &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                        public void onReceivedSslError(WebView view,  </div><div class="line">                                        SslErrorHandler handler, SslError error) &#123;  </div><div class="line">                                super.onReceivedSslError(view, handler, error);  </div><div class="line">                                Log.i(TAG, "onReceivedSslError: ");  </div><div class="line">                        &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                       public boolean shouldOverrideUrlLoading(WebView view, String url) &#123;  </div><div class="line">                                Log.i(TAG, "shouldOverrideUrlLoading: ");  </div><div class="line">                               return super.shouldOverrideUrlLoading(view, url);  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                        public void onReceivedError(WebView view, int errorCode,  </div><div class="line">                                        String description, String failingUrl) &#123;  </div><div class="line">                                super.onReceivedError(view, errorCode, description, failingUrl);  </div><div class="line">                                Log.i(TAG, "onReceivedError: ");  </div><div class="line">                                Log.i(TAG, "errorCode: "+errorCode);  </div><div class="line">                                Log.i(TAG, "description: "+description);  </div><div class="line">                                Log.i(TAG, "failingUrl: "+failingUrl);  </div><div class="line">                        &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                        @Override  </div><div class="line">                        @Deprecated  </div><div class="line">                        public void onTooManyRedirects(WebView view, Message cancelMsg,  </div><div class="line">                                        Message continueMsg) &#123;  </div><div class="line">                                super.onTooManyRedirects(view, cancelMsg, continueMsg);  </div><div class="line">                                Log.i(TAG, "onTooManyRedirects");  </div><div class="line">                        &#125;  </div><div class="line">                          </div><div class="line">                          </div><div class="line">                          </div><div class="line">                &#125;);</div></pre></td></tr></table></figure><h3 id="五、WebChromeClient的使用"><a href="#五、WebChromeClient的使用" class="headerlink" title="五、WebChromeClient的使用"></a><strong>五、WebChromeClient的使用</strong></h3><p>WebChromeClient主要辅助WebView处理Javascript的对话框、网站图标、网站title、加载进度等比如<br>onCloseWindow(关闭WebView)<br>onCreateWindow()<br>onJsAlert (WebView上alert无效，需要定制WebChromeClient处理弹出)<br>onJsPrompt<br>onJsConfirm<br>onProgressChanged<br>onReceivedIcon<br>onReceivedTitle<br>例如以下示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">webView.setWebChromeClient(new WebChromeClient()&#123;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       public void getVisitedHistory(ValueCallback&lt;String[]&gt; callback) &#123;  </div><div class="line">                               super.getVisitedHistory(callback);  </div><div class="line">                               Log.i(TAG, "getVisitedHistory");  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       public void onCloseWindow(WebView window) &#123;  </div><div class="line">                               super.onCloseWindow(window);  </div><div class="line">                               Log.i(TAG, "onCloseWindow");  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       public boolean onCreateWindow(WebView view, boolean isDialog,  </div><div class="line">                                       boolean isUserGesture, Message resultMsg) &#123;  </div><div class="line">                               Log.i(TAG, "onCreateWindow");  </div><div class="line">                               return super.onCreateWindow(view, isDialog, isUserGesture, resultMsg);  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       @Deprecated  </div><div class="line">                       public void onExceededDatabaseQuota(String url,  </div><div class="line">                                       String databaseIdentifier, long quota,  </div><div class="line">                                       long estimatedDatabaseSize, long totalQuota,  </div><div class="line">                                       QuotaUpdater quotaUpdater) &#123;  </div><div class="line">                               super.onExceededDatabaseQuota(url, databaseIdentifier, quota,  </div><div class="line">                                               estimatedDatabaseSize, totalQuota, quotaUpdater);  </div><div class="line">                               Log.i(TAG, "onExceededDatabaseQuota");  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       public void onProgressChanged(WebView view, int newProgress) &#123;  </div><div class="line">                               super.onProgressChanged(view, newProgress);  </div><div class="line">                               Log.i(TAG, "onProgressChanged newProgress "+newProgress);  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       public void onReceivedIcon(WebView view, Bitmap icon) &#123;  </div><div class="line">                               super.onReceivedIcon(view, icon);  </div><div class="line">                               Log.i(TAG, "gonReceivedIcon");  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       public void onReceivedTitle(WebView view, String title) &#123;  </div><div class="line">                               super.onReceivedTitle(view, title);  </div><div class="line">                               Log.i(TAG, "onReceivedTitle");  </div><div class="line">                       &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">                       @Override  </div><div class="line">                       public void onRequestFocus(WebView view) &#123;  </div><div class="line">                               super.onRequestFocus(view);  </div><div class="line">                               Log.i(TAG, "onRequestFocus");  </div><div class="line">                       &#125;  </div><div class="line">               &#125;);</div></pre></td></tr></table></figure><h3 id="六、一些使用的小技巧"><a href="#六、一些使用的小技巧" class="headerlink" title="六、一些使用的小技巧"></a><strong>六、一些使用的小技巧</strong></h3><h4 id="1-打开Android本地文件。"><a href="#1-打开Android本地文件。" class="headerlink" title="1.打开Android本地文件。"></a>1.打开Android本地文件。</h4><p>当网页html文件中有使用到input type=“file”的时候，Android的webview默认是不支持这个标签的，那需要怎么做呢。<br>这个时候需要重写webview的WebChromeClient，以下是示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">webView.setWebChromeClient(new WebChromeClient() &#123;  </div><div class="line">            public void openFileChooser(ValueCallback&lt;Uri&gt; uploadMsg) &#123;  </div><div class="line">  </div><div class="line">  </div><div class="line">                mUploadMessage = uploadMsg;  </div><div class="line">                Intent i = new Intent(Intent.ACTION_GET_CONTENT);  </div><div class="line">                i.addCategory(Intent.CATEGORY_OPENABLE);  </div><div class="line">                i.setType("image/*");  </div><div class="line">                ChangeImgActivity.this.startActivityForResult(  </div><div class="line">                        Intent.createChooser(i, "File Chooser"),  </div><div class="line">                        FILECHOOSER_RESULTCODE);  </div><div class="line">  </div><div class="line">  </div><div class="line">            &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">            public void openFileChooser(ValueCallback uploadMsg,  </div><div class="line">                    String acceptType) &#123;  </div><div class="line">                mUploadMessage = uploadMsg;  </div><div class="line">                Intent i = new Intent(Intent.ACTION_GET_CONTENT);  </div><div class="line">                i.addCategory(Intent.CATEGORY_OPENABLE);  </div><div class="line">                i.setType("*/*");  </div><div class="line">                ChangeImgActivity.this.startActivityForResult(  </div><div class="line">                        Intent.createChooser(i, "File Browser"),  </div><div class="line">                        FILECHOOSER_RESULTCODE);  </div><div class="line">            &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">            public void openFileChooser(ValueCallback&lt;Uri&gt; uploadMsg,  </div><div class="line">                    String acceptType, String capture) &#123;  </div><div class="line">                mUploadMessage = uploadMsg;  </div><div class="line">                Intent i = new Intent(Intent.ACTION_GET_CONTENT);  </div><div class="line">                i.addCategory(Intent.CATEGORY_OPENABLE);  </div><div class="line">                i.setType("image/*");  </div><div class="line">                ChangeImgActivity.this.startActivityForResult(  </div><div class="line">                        Intent.createChooser(i, "File Chooser"),  </div><div class="line">                        ChangeImgActivity.FILECHOOSER_RESULTCODE);  </div><div class="line">  </div><div class="line">  </div><div class="line">            &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">        &#125;);</div></pre></td></tr></table></figure><h4 id="2-浏览网页的回退"><a href="#2-浏览网页的回退" class="headerlink" title="2.浏览网页的回退"></a>2.浏览网页的回退</h4><p>当我们在使用一些浏览器浏览网页的时候，经常会遇到这种功能，点击Android的返回键，就会产生网页回退，这个功能应该如何实现呢。<br>以下是示例代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">webView.setOnKeyListener(new View.OnKeyListener() &#123;  </div><div class="line">            @Override  </div><div class="line">            public boolean onKey(View v, int keyCode, KeyEvent event) &#123;  </div><div class="line">                if (event.getAction() == KeyEvent.ACTION_DOWN) &#123;  </div><div class="line">                    if (keyCode == KeyEvent.KEYCODE_BACK &amp;&amp; webView.canGoBack()) &#123;  </div><div class="line">                        webView.goBack();  </div><div class="line">                        return true;  </div><div class="line">                    &#125;  </div><div class="line">                &#125;  </div><div class="line">                return false;  </div><div class="line">            &#125;  </div><div class="line">        &#125;);</div></pre></td></tr></table></figure><h4 id="3-Android中Java代码和网页中js代码的交互"><a href="#3-Android中Java代码和网页中js代码的交互" class="headerlink" title="3.Android中Java代码和网页中js代码的交互"></a>3.Android中Java代码和网页中js代码的交互</h4><p>在开发中，有时候需要使用Java代码去调用网页中的js代码，或者js代码要调用Java的代码。要实现此功能，首先要设置webview的参数。<br>Java调用js代码较为简单，直接使用loadUrl方法即可。</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">flash_view.loadUrl("javascript:Play()");</div></pre></td></tr></table></figure><p>js代码回调Java代码较为复杂一点。Java 代码：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//设置支持js代码</div><div class="line">web_view.getSettings().setJavaScriptEnabled(true);  </div><div class="line">//设置js代码的回调  </div><div class="line">web_view.addJavascriptInterface(new CallJava(), "CallJava");  </div><div class="line">//js代码的回调  </div><div class="line">private final class CallJava&#123;  </div><div class="line">        public void consoleFlashProgress(float progressSize, int total)&#123;  </div><div class="line">            //设置播放进度条  </div><div class="line">            showFlashProgress(progressSize, total);  </div><div class="line">        &#125;  </div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>JS 代码：<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//动态显示播放影片的当前桢/总桢数(进度条显示)</div><div class="line">function showcount()&#123;  </div><div class="line">                total = movie.TotalFrames();  </div><div class="line">                frame_number = movie.CurrentFrame();  </div><div class="line">                frame_number++;  </div><div class="line">                var progressSize = 500*(frame_number/total);  </div><div class="line">                CallJava.consoleFlashProgress(progressSize,total/12);  </div><div class="line">            &#125;</div></pre></td></tr></table></figure><p></p><p>注：一下代码很大一部分摘抄自网络，在此感谢各位代码提供者。作者只是做了整理和总结，希望能帮到各位开发者</p></div><footer class="article-footer clearfix"><div class="article-catetags"><div class="article-categories"><span></span> <a class="article-category-link" href="/categories/Android/">Android</a></div><div class="article-tags"><span></span> <a href="/tags/Android/">Android</a></div></div><div class="article-share" id="share"><div class="share-jiathis"><div class="jiathis_style_24x24"><a class="jiathis_button_tsina"></a> <a class="jiathis_button_weixin"></a> <a class="jiathis_button_renren"></a> <a class="jiathis_button_qzone"></a> <a class="jiathis_button_googleplus"></a> <a class="jiathis_button_douban"></a> <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",</script><script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div><div class="article-share" id="share"><div class="share-jiathis"><div class="jiathis_style_24x24"><a class="jiathis_button_tsina"></a> <a class="jiathis_button_weixin"></a> <a class="jiathis_button_renren"></a> <a class="jiathis_button_qzone"></a> <a class="jiathis_button_googleplus"></a> <a class="jiathis_button_douban"></a> <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",</script><script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></footer></article><nav class="article-nav clearfix"><div class="prev"><a href="/xinliu/f955b66/" title="Intent传递对象的两种方法"><strong>上一篇：</strong><br><span>Intent传递对象的两种方法</span></a></div><div class="next"><a href="/xinliu/3123977d/" title="Hexo教程(三)-hexo博客同时托管到github和coding"><strong>下一篇：</strong><br><span>Hexo教程(三)-hexo博客同时托管到github和coding</span></a></div></nav><div id="lv-container" data-id="city" data-uid="MTAyMC8zMzQ2Ny8xMDAyMw=="><script type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><noscript>为正常使用来必力评论功能请激活JavaScript</noscript></div></div><div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div><div id="toc" class="toc-aside"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、什么是WebView"><span class="toc-number">1.</span> <span class="toc-text">一、什么是WebView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、WebView的使用方式"><span class="toc-number">2.</span> <span class="toc-text">二、WebView的使用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-实例化一个WebView"><span class="toc-number">2.1.</span> <span class="toc-text">1. 实例化一个WebView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-调用WebView的loadUrl-方法，设置WevView要显示的网页："><span class="toc-number">2.2.</span> <span class="toc-text">2. 调用WebView的loadUrl()方法，设置WevView要显示的网页：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-需要在AndroidManifest-xml文件中添加权限，否则会出现Web-page-not-available错误"><span class="toc-number">2.3.</span> <span class="toc-text">3. 需要在AndroidManifest.xml文件中添加权限，否则会出现Web page not available错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-不同的使用方法"><span class="toc-number">2.4.</span> <span class="toc-text">4. 不同的使用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-webview的关闭"><span class="toc-number">2.5.</span> <span class="toc-text">5. webview的关闭</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、webview的参数设置"><span class="toc-number">3.</span> <span class="toc-text">三、webview的参数设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、WebViewClient的使用"><span class="toc-number">4.</span> <span class="toc-text">四、WebViewClient的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、WebChromeClient的使用"><span class="toc-number">5.</span> <span class="toc-text">五、WebChromeClient的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六、一些使用的小技巧"><span class="toc-number">6.</span> <span class="toc-text">六、一些使用的小技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-打开Android本地文件。"><span class="toc-number">6.1.</span> <span class="toc-text">1.打开Android本地文件。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-浏览网页的回退"><span class="toc-number">6.2.</span> <span class="toc-text">2.浏览网页的回退</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Android中Java代码和网页中js代码的交互"><span class="toc-number">6.3.</span> <span class="toc-text">3.Android中Java代码和网页中js代码的交互</span></a></li></ol></li></ol></div><div id="asidepart"><div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div><aside class="clearfix"><div style="width:300px;height:150px;transform:scale(.7);margin:0;margin-left:-50px;margin-bottom:-65px;margin-top:10px"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=355992&auto=0&height=66"></iframe></div><div class="github-card"><p class="asidetitle">Github</p><div class="github-card" data-github="EARL8888" data-theme="medium"></div><script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script></div><div class="categorieslist"><p class="asidetitle">分类</p><ul><li><a href="/categories/Android/" title="Android">Android<sup>5</sup></a></li><li><a href="/categories/AngularJS-01/" title="AngularJS_01">AngularJS_01<sup>1</sup></a></li><li><a href="/categories/CSS/" title="CSS">CSS<sup>1</sup></a></li><li><a href="/categories/Ionic/" title="Ionic">Ionic<sup>1</sup></a></li><li><a href="/categories/git/" title="git">git<sup>1</sup></a></li><li><a href="/categories/gulp/" title="gulp">gulp<sup>1</sup></a></li><li><a href="/categories/hexo/" title="hexo">hexo<sup>10</sup></a></li><li><a href="/categories/java/" title="java">java<sup>1</sup></a></li><li><a href="/categories/vue/" title="vue">vue<sup>2</sup></a></li><li><a href="/categories/前端开发规范手册/" title="前端开发规范手册">前端开发规范手册<sup>1</sup></a></li></ul></div><div class="tagslist"><p class="asidetitle">标签</p><ul class="clearfix"><li><a href="/tags/hexo/" title="hexo">hexo<sup>10</sup></a></li><li><a href="/tags/Android/" title="Android">Android<sup>5</sup></a></li><li><a href="/tags/vue/" title="vue">vue<sup>2</sup></a></li><li><a href="/tags/AngularJS-01/" title="AngularJS_01">AngularJS_01<sup>1</sup></a></li><li><a href="/tags/CSS/" title="CSS">CSS<sup>1</sup></a></li><li><a href="/tags/Ionic/" title="Ionic">Ionic<sup>1</sup></a></li><li><a href="/tags/java/" title="java">java<sup>1</sup></a></li><li><a href="/tags/gulp/" title="gulp">gulp<sup>1</sup></a></li><li><a href="/tags/git/" title="git">git<sup>1</sup></a></li><li><a href="/tags/前端开发规范手册/" title="前端开发规范手册">前端开发规范手册<sup>1</sup></a></li></ul></div><div class="linkslist"><p class="asidetitle">友情链接</p><ul><li><a href="http://www.cnblogs.com/earl-yongchang/" target="_blank" title=" 以前写作博客">博客园</a></li><li><a href="http://www.infoq.com/cn/" target="_blank" title=" 促进软件开发领域知识与创新的传播">InfoQ</a></li><li><a href="https://sdk.cn/" target="_blank" title=" 中国领先的开发者服务">开发者服务</a></li><li><a href="https://www.cnblogs.com/TomXu/archive/2011/12/15/2288411.html#undefined 深入理解JavaScript系列文章" target="_blank" title="汤姆大叔">汤姆大叔</a></li></ul></div><div class="weiboshow"><p class="asidetitle">新浪微博</p><iframe width="100%" height="119" class="share_self" frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=5807798537&verifier=5fcd6856&dpc=1"></iframe></div></aside></div></div><footer><div id="footer"><div class="line"><span></span><div class="author"></div></div><section class="info"><p>Keep Calm<br>Carry On</p></section><div class="social-font" class="clearfix"><a href="http://weibo.com/5807798537" target="_blank" class="icon-weibo" title="微博"></a> <a href="https://github.com/EARL8888" target="_blank" class="icon-github" title="github"></a> <a href="mailto:z604458675@gmail.com" target="_blank" class="icon-email" title="Email Me"></a></div></div><div class="footer-text"><p class="copyright"><a href="/about" target="_blank" title="earl">earl | 农民艺术家</a> Copyright © 2019</p><span id="busuanzi_container_site_uv">本站访客数 <span id="busuanzi_value_site_uv"></span> 人次<p><a style="color:#fff" href="http://www.miitbeian.gov.cn/" target="_blank">京ICP备19006937号-1</a></p></span></div><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></footer><script src="/js/jquery-2.0.3.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><script src="/js/jquery.qrcode-0.12.0.min.js"></script><script type="text/javascript">$(document).ready(function(){$(".navbar").click(function(){$("header nav").toggleClass("shownav")});var e=0,s=$("#main"),n=$("#asidepart"),a=$(".closeaside"),o=$(".openaside");a.click(function(){n.addClass("fadeOut").css("display","none"),o.css("display","block").addClass("fadeIn"),s.addClass("moveMain")}),o.click(function(){o.css("display","none").removeClass("beforeFadeIn"),n.css("display","block").removeClass("fadeOut").addClass("fadeIn"),s.removeClass("moveMain")}),$(window).scroll(function(){o.css("top",Math.max(80,260-$(this).scrollTop()))}),$(window).resize(function(){"number"==typeof window.innerWidth?e=window.innerWidth:document.documentElement&&document.documentElement.clientWidth&&(e=document.documentElement.clientWidth),1024<=e?$("header nav").removeClass("shownav"):(s.removeClass("moveMain"),n.css("display","block").removeClass("fadeOut"),o.css("display","none"),$("#toc.toc-aside").css("display","none"))})})</script><script type="text/javascript">$(document).ready(function(){var c=$(".article-content>iframe"),n=$(".article-content>embed"),o=($("#toc"),$("#toc.toc-aside")),e=$(".openaside"),i=$(".closeaside");0<c.length&&c.wrap('<div class="video-container" />'),0<n.length&&n.wrap('<div class="video-container" />'),i.click(function(){o.css("display","block").addClass("fadeIn")}),e.click(function(){o.css("display","none")}),$(window).scroll(function(){o.css("top",Math.max(140,320-$(this).scrollTop()))})})</script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">$(document).ready(function(){$(".article-content").each(function(a){$(this).find("img").each(function(){if(!$(this).parent().hasClass("fancybox")){var a=this.alt;a&&$(this).after('<span class="caption">'+a+"</span>"),$(this).wrap('<a href="'+this.src+'" title="'+a+'" class="fancybox"></a>')}}),$(this).find(".fancybox").each(function(){$(this).attr("rel","article"+a)})}),$.fancybox&&$(".fancybox").fancybox()})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?13fd776f810bd0d42243353eab26fad6";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div id="totop"><a title="返回顶部"><img src="/img/scrollup.png"></a></div><script src="/js/totop.js"></script></body>