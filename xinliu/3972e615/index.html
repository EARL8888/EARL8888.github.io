<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="“Content-Security-Policy”" content="“upgrade-insecure-requests”/"><title>添加登录权限验证 | 农民艺术家</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="author" content="earl"><meta name="description" content="书接上文，有个遗留问题使用eslint 着实烦人，打开package.json文件，发现一坨这个插件，so卸载掉。在 build/webpack.base.conf.js文件中把 关于eslint的都删掉。世界又回到了宁静！！！开始写login权限以及cookie认证安装依赖插件添加网络请求拦截在config文件下新建 http.js文件123456789101112131415161718192"><meta property="og:type" content="article"><meta property="og:title" content="添加登录权限验证"><meta property="og:url" content="http://xinliu.vip/xinliu/3972e615/index.html"><meta property="og:site_name" content="农民艺术家"><meta property="og:description" content="书接上文，有个遗留问题使用eslint 着实烦人，打开package.json文件，发现一坨这个插件，so卸载掉。在 build/webpack.base.conf.js文件中把 关于eslint的都删掉。世界又回到了宁静！！！开始写login权限以及cookie认证安装依赖插件添加网络请求拦截在config文件下新建 http.js文件123456789101112131415161718192"><meta property="og:image" content="http://xinliu.vip/../../images/vue/vue_eslint.png"><meta property="og:image" content="http://xinliu.vip/../../images/vue/eslint-plugin.png"><meta property="og:image" content="http://xinliu.vip/../../images/vue/uninstall-eslint.png"><meta property="og:image" content="http://xinliu.vip/../../images/vue/vue-plugin.png"><meta property="og:image" content="http://xinliu.vip/../../images/vue/vue-login.gif"><meta property="og:updated_time" content="2019-03-21T03:34:38.129Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="添加登录权限验证"><meta name="twitter:description" content="书接上文，有个遗留问题使用eslint 着实烦人，打开package.json文件，发现一坨这个插件，so卸载掉。在 build/webpack.base.conf.js文件中把 关于eslint的都删掉。世界又回到了宁静！！！开始写login权限以及cookie认证安装依赖插件添加网络请求拦截在config文件下新建 http.js文件123456789101112131415161718192"><meta name="twitter:image" content="http://xinliu.vip/../../images/vue/vue_eslint.png"><link rel="alternative" href="/atom.xml" title="农民艺术家" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="apple-touch-icon" href="/img/jacman.jpg"><link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg"><link rel="stylesheet" href="/css/style.css"></head></html><body><header><div><div id="imglogo"><a href="/"><img src="/img/logo.png" alt="农民艺术家" title="农民艺术家"></a></div><div id="textlogo"><h1 class="site-name"><a href="/" title="农民艺术家">农民艺术家</a></h1><h2 class="blog-motto">Keep Calm and Carry On</h2></div><div class="navbar"><a class="navbutton navmobile" href="#" title="菜单"></a></div><nav class="animated"><ul><ul><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">简介</a></li><li></li></ul></ul></nav></div></header><div id="container"><div id="main" class="post" itemscope itemprop="blogPost"><article itemprop="articleBody"><header class="article-info clearfix"><h1 itemprop="name"><a href="/xinliu/3972e615/" title="添加登录权限验证" itemprop="url">添加登录权限验证</a></h1><p class="article-author">By <a href="/about" title="earl" target="_blank" itemprop="author">earl</a></p><p class="article-time"><span class="head-plus">阅读<i class="fa fa-user"></i><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>次, </span><span class="head-plus"><i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="xinliu/3972e615/"><i class="fa fa-spinner fa-spin"></i></span> </span><time datetime="2018-06-03T14:43:05.000Z" itemprop="datePublished">发表于 2018-06-03</time></p></header><div class="article-content"><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装依赖插件"><span class="toc-number">1.</span> <span class="toc-text">安装依赖插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加网络请求拦截"><span class="toc-number">2.</span> <span class="toc-text">添加网络请求拦截</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#新建登录页，并添加cooking认证"><span class="toc-number">3.</span> <span class="toc-text">新建登录页，并添加cooking认证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#登录页"><span class="toc-number">3.1.</span> <span class="toc-text">登录页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#添加cookie认证"><span class="toc-number">3.2.</span> <span class="toc-text">添加cookie认证</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#现在就看到效果了"><span class="toc-number">4.</span> <span class="toc-text">现在就看到效果了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用到的save-util-js文件"><span class="toc-number">5.</span> <span class="toc-text">用到的save_util.js文件</span></a></li></ol></div><p>书接上文，有个遗留问题<br><img src="../../images/vue/vue_eslint.png" width="500"></p><p>使用eslint 着实烦人，打开package.json文件，<br><img src="../../images/vue/eslint-plugin.png" width="500">发现一坨这个插件，so卸载掉。在 build/webpack.base.conf.js文件中把 关于eslint的都删掉。</p><p><img src="../../images/vue/uninstall-eslint.png" width="500"><br>世界又回到了宁静！！！</p><p>开始写login权限以及cookie认证</p><h3 id="安装依赖插件"><a href="#安装依赖插件" class="headerlink" title="安装依赖插件"></a>安装依赖插件</h3><p><img src="../../images/vue/vue-plugin.png" width="500"></p><h3 id="添加网络请求拦截"><a href="#添加网络请求拦截" class="headerlink" title="添加网络请求拦截"></a>添加网络请求拦截</h3><p>在config文件下新建 http.js文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">    Author: earl</div><div class="line">    Create Time: 2018-06-03 18:50</div><div class="line">**/</div><div class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></div><div class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span></div><div class="line"><span class="keyword">import</span> &#123;baseURL&#125; <span class="keyword">from</span> <span class="string">"./url"</span></div><div class="line"><span class="keyword">import</span> &#123;getStore&#125; <span class="keyword">from</span> <span class="string">'../utils/save_util'</span></div><div class="line"></div><div class="line">axios.interceptors.request.use(config =&gt; &#123;</div><div class="line">  <span class="keyword">return</span> config</div><div class="line">&#125;, error =&gt; &#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</div><div class="line">&#125;);</div><div class="line"></div><div class="line">axios.interceptors.response.use(response =&gt; &#123;</div><div class="line">  <span class="keyword">return</span> response</div><div class="line">&#125;, error =&gt; &#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(error.response)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkStatus</span>(<span class="params">response</span>) </span>&#123;</div><div class="line"><span class="comment">// 如果http状态码正常，则直接返回数据</span></div><div class="line">  <span class="keyword">if</span> (response) &#123;</div><div class="line">    <span class="keyword">return</span> response;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> &#123;<span class="comment">// 这里已经包括网络错误，服务器错误，后端抛出的错误，可以弹出一个错误提示，告诉用户</span></div><div class="line">    data: &#123;</div><div class="line">      code: <span class="number">1</span>,</div><div class="line">      msg: <span class="string">'网络异常！'</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkCode</span>(<span class="params">res, url, params</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (res.data) res = res.data;</div><div class="line">  <span class="keyword">if</span> (res.code || res.code !== <span class="number">0</span>) &#123;</div><div class="line"><span class="comment">//异常监控上报</span></div><div class="line">    uploadLog(res, url, params);</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      res.msg = res.msg ? res.msg : <span class="string">'网络异常！'</span>;</div><div class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">      res = &#123;</div><div class="line">        code: <span class="number">1</span>,</div><div class="line">        msg: <span class="string">'网络异常！'</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">uploadLog</span>(<span class="params">res, url, send_params</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> status = res.code;</div><div class="line">  <span class="keyword">if</span> (!res.code) status = <span class="number">1</span>;</div><div class="line"><span class="comment">//异常监控上报</span></div><div class="line">  axios.get(<span class="string">'http://xes-zxxb.cn-beijing.log.aliyuncs.com/logstores/app_log/track.gif'</span>, &#123;</div><div class="line">    params: &#123;</div><div class="line">      APIVersion: <span class="string">'0.6.0'</span>,</div><div class="line">      device_model: <span class="built_in">window</span>.navigator.appVersion,</div><div class="line">      __topic__: url,</div><div class="line">      __level__: <span class="string">'error'</span>,</div><div class="line">      __device__: <span class="string">'web'</span>,</div><div class="line">      _params_: send_params,</div><div class="line">      status: status,</div><div class="line">      url: url,</div><div class="line">      app_version: <span class="number">1.0</span></div><div class="line">    &#125;</div><div class="line">  &#125;).then(res =&gt; &#123;</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  post(url, params) &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> params) &#123; <span class="comment">// 解决php后台无法读取收据</span></div><div class="line">      <span class="keyword">if</span> (params.hasOwnProperty(i) &amp;&amp; <span class="keyword">typeof</span> params[i] != <span class="string">"function"</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> (params[i]) == <span class="string">"object"</span>) &#123;</div><div class="line">          params[i] = <span class="built_in">JSON</span>.stringify(params[i]);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> axios(&#123;</div><div class="line">      headers: &#123;</div><div class="line">        <span class="string">'Authorization'</span>: <span class="string">"Bearer "</span> + getStore(<span class="string">'userToken'</span>)</div><div class="line">      &#125;,</div><div class="line">      method: <span class="string">'post'</span>,</div><div class="line">      baseURL: baseURL,</div><div class="line">      url,</div><div class="line">      data: qs.stringify(params),</div><div class="line">      timeout: <span class="number">10000</span></div><div class="line">    &#125;).then(</div><div class="line">      (response) =&gt; &#123;</div><div class="line">        <span class="keyword">return</span> checkStatus(response)</div><div class="line">      &#125;</div><div class="line">    ).then(</div><div class="line">      (res) =&gt; &#123;</div><div class="line">        <span class="keyword">return</span> checkCode(res, url, params)</div><div class="line">      &#125;</div><div class="line">    )</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  get(url, params) &#123;</div><div class="line">    <span class="keyword">return</span> axios(&#123;</div><div class="line">      method: <span class="string">'get'</span>,</div><div class="line">      baseURL: baseURL,</div><div class="line">      url,</div><div class="line">      params,</div><div class="line">      timeout: <span class="number">10000</span>,</div><div class="line">      headers: &#123;</div><div class="line">        <span class="string">'Authorization'</span>: <span class="string">"Bearer "</span> + getStore(<span class="string">'userToken'</span>)</div><div class="line">      &#125;</div><div class="line">    &#125;).then(</div><div class="line">      (response) =&gt; &#123;</div><div class="line">        <span class="keyword">return</span> checkStatus(response)</div><div class="line">      &#125;</div><div class="line">    ).then(</div><div class="line">      (res) =&gt; &#123;</div><div class="line">        <span class="keyword">return</span> checkCode(res, url, params)</div><div class="line">      &#125;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="新建登录页，并添加cooking认证"><a href="#新建登录页，并添加cooking认证" class="headerlink" title="新建登录页，并添加cooking认证"></a>新建登录页，并添加cooking认证</h3><h4 id="登录页"><a href="#登录页" class="headerlink" title="登录页"></a>登录页</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div></pre></td><td class="code"><pre><div class="line">&lt;!--</div><div class="line">    Author: earl</div><div class="line">    Create Time: <span class="number">2018</span><span class="number">-06</span><span class="number">-03</span> <span class="number">23</span>:<span class="number">10</span></div><div class="line">    Description:</div><div class="line">--&gt;</div><div class="line">&lt;template&gt;</div><div class="line">  &lt;div class="login_page fillcontain"&gt;</div><div class="line">    &lt;transition name="form-fade" mode="in-out"&gt;</div><div class="line">      &lt;section class="form_contianer" v-show="showLogin"&gt;</div><div class="line">        &lt;div class="manage_tip"&gt;</div><div class="line">          &lt;p&gt;vue-project&lt;/p&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">        &lt;el-form :model="loginForm" :rules="rules" ref="loginForm"&gt;</div><div class="line">          &lt;el-form-item prop="email"&gt;</div><div class="line">            &lt;el-input v-model="loginForm.email" @keyup.enter.native="submitForm('loginForm')"</div><div class="line">                      placeholder="邮箱"&gt;&lt;/el-input&gt;</div><div class="line">          &lt;/el-form-item&gt;</div><div class="line">          &lt;el-form-item prop="password"&gt;</div><div class="line">            &lt;el-input @keyup.enter.native="submitForm('loginForm')" type="password" placeholder="密码"</div><div class="line">                      v-model="loginForm.password"&gt;&lt;/el-input&gt;</div><div class="line">          &lt;/el-form-item&gt;</div><div class="line">          &lt;el-form-item&gt;</div><div class="line">            &lt;el-button type="primary" @click="submitForm('loginForm')" class="submit_btn"&gt;登录&lt;/el-button&gt;</div><div class="line">          &lt;/el-form-item&gt;</div><div class="line">        &lt;/el-form&gt;</div><div class="line">      &lt;/section&gt;</div><div class="line">    &lt;/transition&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">  import http from '../../config/http'</div><div class="line">  import &#123;setStore&#125; from '../../utils/save_util'</div><div class="line"></div><div class="line">  export default &#123;</div><div class="line">    data() &#123;</div><div class="line">      return &#123;</div><div class="line">        loginForm: &#123;</div><div class="line">          email: '',</div><div class="line">          password: '',</div><div class="line">        &#125;,</div><div class="line">        rules: &#123;</div><div class="line">          email: [</div><div class="line">            &#123;required: true, message: '请输入邮箱', trigger: 'blur,change'&#125;,</div><div class="line">            &#123;max: 50, message: '最多输入50个字符！', trigger: 'blur,change'&#125;,</div><div class="line">            &#123;type: 'email', message: '邮箱格式错误!', trigger: 'blur,change'&#125;</div><div class="line">          ],</div><div class="line">          password: [</div><div class="line">            &#123;required: true, message: '请输入密码', trigger: 'blur,change'&#125;,</div><div class="line">            &#123;max: 20, message: '最多输入20个字符！', trigger: 'blur,change'&#125;</div><div class="line">          ],</div><div class="line">        &#125;,</div><div class="line">        showLogin: false,</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    mounted() &#123;</div><div class="line">      this.showLogin = true;</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">      uploadLoading(tag) &#123;</div><div class="line">        if (tag) &#123;</div><div class="line">          this.uploadLoadingObj = this.$loading(&#123;</div><div class="line">            lock: true,</div><div class="line">            text: '拼命登录中，请等待...',</div><div class="line">            spinner: 'el-icon-loading',</div><div class="line">            background: 'rgba(0, 0, 0, 0.7)'</div><div class="line">          &#125;);</div><div class="line">        &#125; else &#123;</div><div class="line">          if (!this.uploadLoadingObj) return;</div><div class="line">          this.uploadLoadingObj.close();</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      submitForm: async function (loginForm) &#123;</div><div class="line">        this.$refs[loginForm].validate((valid) =&gt; &#123;</div><div class="line">          if (valid) &#123;</div><div class="line">            this.uploadLoading(true);</div><div class="line">            let params = &#123;email: this.loginForm.email, password: this.loginForm.password&#125;;</div><div class="line">            http.post("/", params).then(res =&gt; &#123;</div><div class="line">              if (res.code === 0) &#123;</div><div class="line">                let expireHours = 60 * 60 * 6;//登录状态6小时后过期</div><div class="line">                this.setCookie('session', res.data.token, expireHours);</div><div class="line">                this.$router.push('/index');</div><div class="line">                this.$message(&#123;</div><div class="line">                  type: 'success',</div><div class="line">                  message: '登录成功',</div><div class="line">                  duration: 1000</div><div class="line">                &#125;);</div><div class="line">              &#125; else &#123;</div><div class="line">                this.$message(&#123;</div><div class="line">                  type: 'error',</div><div class="line">                  message: res.msg</div><div class="line">                &#125;);</div><div class="line">              &#125;</div><div class="line">              this.uploadLoading(false);</div><div class="line">            &#125;)</div><div class="line">          &#125; else &#123;</div><div class="line">            this.regFun(); //校验邮箱和密码</div><div class="line">            return false;</div><div class="line">          &#125;</div><div class="line">        &#125;);</div><div class="line">      &#125;,</div><div class="line">      regFun: function () &#123;</div><div class="line">        let regEmail = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]&#123;2,3&#125;)&#123;1,2&#125;)$/;</div><div class="line">        if (!this.loginForm.email &amp;&amp; !this.loginForm.password) return this.$notify.error(&#123;</div><div class="line">          title: '错误',</div><div class="line">          message: '请输入邮箱！',</div><div class="line">          offset: 100</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        if (!this.loginForm.email) return this.$notify.error(&#123;</div><div class="line">          title: '错误',</div><div class="line">          message: '请输入邮箱！',</div><div class="line">          offset: 100</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        if (!regEmail.test(this.loginForm.email)) return this.$notify.error(&#123;</div><div class="line">          title: '错误',</div><div class="line">          message: '邮箱格式错误！',</div><div class="line">          offset: 100</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        if (this.loginForm.email.length &gt; 50) return this.$notify.error(&#123;</div><div class="line">          title: '错误',</div><div class="line">          message: '邮箱最多输入50个字符！',</div><div class="line">          offset: 100</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        if (!this.loginForm.password) return this.$notify.error(&#123;</div><div class="line">          title: '错误',</div><div class="line">          message: '请输入密码！',</div><div class="line">          offset: 100</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        if (this.loginForm.password.length &gt; 20) return this.$notify.error(&#123;</div><div class="line">          title: '错误',</div><div class="line">          message: '密码最多输入20个字符！',</div><div class="line">          offset: 100</div><div class="line">        &#125;);</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    watch: &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&lt;/script&gt;</div><div class="line"></div><div class="line">&lt;style lang="less" scoped&gt;</div><div class="line">  @import "../../../static/css/mixin";</div><div class="line"></div><div class="line">  .login_page &#123;</div><div class="line">    background-color: #324057;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  .manage_tip &#123;</div><div class="line">    position: absolute;</div><div class="line">    width: 100%;</div><div class="line">    top: -100px;</div><div class="line">    left: 0;</div><div class="line">    p &#123;</div><div class="line">      font-size: 34px;</div><div class="line">      color: #fff;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  .form_contianer &#123;</div><div class="line">    .wh(320px, 210px);</div><div class="line">    .ctp(320px, 210px);</div><div class="line">    padding: 25px;</div><div class="line">    border-radius: 5px;</div><div class="line">    text-align: center;</div><div class="line">    background-color: #fff;</div><div class="line">    .submit_btn &#123;</div><div class="line">      width: 100%;</div><div class="line">      font-size: 16px;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  .form-fade-enter-active, .form-fade-leave-active &#123;</div><div class="line">    transition: all 1s;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  .form-fade-enter, .form-fade-leave-active &#123;</div><div class="line">    transform: translate3d(0, -50px, 0);</div><div class="line">    opacity: 0;</div><div class="line">  &#125;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure><p>并在路由router文件夹下的index.js进行注册</p><h4 id="添加cookie认证"><a href="#添加cookie认证" class="headerlink" title="添加cookie认证"></a>添加cookie认证</h4><p>在main.js 文件中添加</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// The Vue build version to load with the `import` command</span></div><div class="line"><span class="comment">// (runtime-only or standalone) has been set in webpack.base.conf with an alias.</span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></div><div class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></div><div class="line"><span class="keyword">import</span> ElementUI <span class="keyword">from</span> <span class="string">'element-ui'</span></div><div class="line"><span class="keyword">import</span> <span class="string">'element-ui/lib/theme-chalk/index.css'</span></div><div class="line"><span class="keyword">import</span> <span class="string">'../static/css/base.css'</span></div><div class="line"><span class="keyword">import</span> &#123;removeStore&#125; <span class="keyword">from</span> <span class="string">'./utils/save_util'</span></div><div class="line"></div><div class="line">Vue.config.productionTip = <span class="literal">false</span></div><div class="line"></div><div class="line">Vue.use(ElementUI)</div><div class="line"></div><div class="line"><span class="comment">//设置cookie,增加到vue实例方便全局调用</span></div><div class="line"><span class="comment">//vue全局调用的理由是，有些组件所用到的接口可能需要session验证，session从cookie获取</span></div><div class="line">Vue.prototype.setCookie = (c_name, value, expireHours) =&gt; &#123;</div><div class="line">  <span class="keyword">var</span> exdate = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">  exdate.setDate(exdate.getDate() + expireHours);</div><div class="line">  <span class="built_in">document</span>.cookie = c_name + <span class="string">"="</span> + <span class="built_in">escape</span>(value) + ((expireHours == <span class="literal">null</span>) ? <span class="string">""</span> : <span class="string">";expires="</span> + exdate.toGMTString()) + <span class="string">";max-age="</span> + expireHours;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//获取cookie、</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> arr, reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^| )"</span> + name + <span class="string">"=([^;]*)(;|$)"</span>);</div><div class="line">  <span class="keyword">if</span> (arr = <span class="built_in">document</span>.cookie.match(reg))</div><div class="line">    <span class="keyword">return</span> (arr[<span class="number">2</span>]);</div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Vue.prototype.getCookie = getCookie;</div><div class="line"></div><div class="line"><span class="comment">//删除cookie</span></div><div class="line">Vue.prototype.delCookie = (name) =&gt; &#123;</div><div class="line">  <span class="keyword">var</span> exp = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">  exp.setTime(exp.getTime() - <span class="number">1</span>);</div><div class="line">  <span class="keyword">var</span> cval = getCookie(name);</div><div class="line">  <span class="keyword">if</span> (cval != <span class="literal">null</span>)</div><div class="line">    <span class="built_in">document</span>.cookie = name + <span class="string">"="</span> + cval + <span class="string">";expires="</span> + exp.toGMTString();</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">/* eslint-disable no-new */</span></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  el: <span class="string">'#app'</span>,</div><div class="line">  router,</div><div class="line">  components: &#123; App &#125;,</div><div class="line">  template: <span class="string">'&lt;App/&gt;'</span>,</div><div class="line">  watch: &#123;</div><div class="line">    <span class="string">"$route"</span>: <span class="string">'checkLogin'</span></div><div class="line">  &#125;,</div><div class="line">  created() &#123;</div><div class="line">    <span class="keyword">this</span>.checkLogin();</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    checkLogin() &#123;</div><div class="line">      <span class="comment">//检查是否存在session</span></div><div class="line">      <span class="keyword">if</span> (!<span class="keyword">this</span>.getCookie(<span class="string">'session'</span>)) &#123;</div><div class="line">        <span class="keyword">this</span>.$router.push(<span class="string">'/login'</span>);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">let</span> routeName = <span class="keyword">this</span>.$route.path;</div><div class="line">        <span class="keyword">if</span> (!routeName || routeName === <span class="string">"/login"</span>) <span class="keyword">this</span>.$router.push(<span class="string">'/classMS'</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><h3 id="现在就看到效果了"><a href="#现在就看到效果了" class="headerlink" title="现在就看到效果了"></a>现在就看到效果了</h3><p><img src="../../images/vue/vue-login.gif" width="800"></p><h3 id="用到的save-util-js文件"><a href="#用到的save-util-js文件" class="headerlink" title="用到的save_util.js文件"></a>用到的save_util.js文件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Author: earl</div><div class="line"> * Create Time: 2018-03-15 12:13</div><div class="line"> * Description: 工具</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 存储localStorage</div><div class="line"> */</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> setStore = (name, content) =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (!name) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span>  content !== <span class="string">'string'</span>) &#123;</div><div class="line">         content = <span class="built_in">JSON</span>.stringify(content);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">window</span>.localStorage.setItem(name, content);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 获取localStorage</div><div class="line"> */</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> getStore = name =&gt; &#123;</div><div class="line">  <span class="keyword">if</span>(!name) <span class="keyword">return</span>;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">window</span>.localStorage.getItem(name);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 删除localStorage</div><div class="line"> */</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> removeStore = name =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (!name) <span class="keyword">return</span>;</div><div class="line">    <span class="built_in">window</span>.localStorage.removeItem(name);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></div><footer class="article-footer clearfix"><div class="article-catetags"><div class="article-categories"><span></span> <a class="article-category-link" href="/categories/vue/">vue</a></div><div class="article-tags"><span></span> <a href="/tags/vue/">vue</a></div></div><div class="article-share" id="share"><div class="share-jiathis"><div class="jiathis_style_24x24"><a class="jiathis_button_tsina"></a> <a class="jiathis_button_weixin"></a> <a class="jiathis_button_renren"></a> <a class="jiathis_button_qzone"></a> <a class="jiathis_button_googleplus"></a> <a class="jiathis_button_douban"></a> <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",</script><script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div><div class="article-share" id="share"><div class="share-jiathis"><div class="jiathis_style_24x24"><a class="jiathis_button_tsina"></a> <a class="jiathis_button_weixin"></a> <a class="jiathis_button_renren"></a> <a class="jiathis_button_qzone"></a> <a class="jiathis_button_googleplus"></a> <a class="jiathis_button_douban"></a> <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",</script><script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></footer></article><nav class="article-nav clearfix"><div class="next"><a href="/xinliu/e68dff05/" title="新建vue工程"><strong>下一篇：</strong><br><span>新建vue工程</span></a></div></nav><div id="lv-container" data-id="city" data-uid="MTAyMC8zMzQ2Ny8xMDAyMw=="><script type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><noscript>为正常使用来必力评论功能请激活JavaScript</noscript></div></div><div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div><div id="toc" class="toc-aside"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装依赖插件"><span class="toc-number">1.</span> <span class="toc-text">安装依赖插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加网络请求拦截"><span class="toc-number">2.</span> <span class="toc-text">添加网络请求拦截</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#新建登录页，并添加cooking认证"><span class="toc-number">3.</span> <span class="toc-text">新建登录页，并添加cooking认证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#登录页"><span class="toc-number">3.1.</span> <span class="toc-text">登录页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#添加cookie认证"><span class="toc-number">3.2.</span> <span class="toc-text">添加cookie认证</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#现在就看到效果了"><span class="toc-number">4.</span> <span class="toc-text">现在就看到效果了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用到的save-util-js文件"><span class="toc-number">5.</span> <span class="toc-text">用到的save_util.js文件</span></a></li></ol></div><div id="asidepart"><div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div><aside class="clearfix"><div style="width:300px;height:150px;transform:scale(.7);margin:0;margin-left:-50px;margin-bottom:-65px;margin-top:10px"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=355992&auto=0&height=66"></iframe></div><div class="github-card"><p class="asidetitle">Github</p><div class="github-card" data-github="EARL8888" data-theme="medium"></div><script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script></div><div class="categorieslist"><p class="asidetitle">分类</p><ul><li><a href="/categories/Android/" title="Android">Android<sup>5</sup></a></li><li><a href="/categories/AngularJS-01/" title="AngularJS_01">AngularJS_01<sup>1</sup></a></li><li><a href="/categories/CSS/" title="CSS">CSS<sup>1</sup></a></li><li><a href="/categories/Ionic/" title="Ionic">Ionic<sup>1</sup></a></li><li><a href="/categories/git/" title="git">git<sup>1</sup></a></li><li><a href="/categories/gulp/" title="gulp">gulp<sup>1</sup></a></li><li><a href="/categories/hexo/" title="hexo">hexo<sup>10</sup></a></li><li><a href="/categories/java/" title="java">java<sup>1</sup></a></li><li><a href="/categories/vue/" title="vue">vue<sup>2</sup></a></li><li><a href="/categories/前端开发规范手册/" title="前端开发规范手册">前端开发规范手册<sup>1</sup></a></li></ul></div><div class="tagslist"><p class="asidetitle">标签</p><ul class="clearfix"><li><a href="/tags/hexo/" title="hexo">hexo<sup>10</sup></a></li><li><a href="/tags/Android/" title="Android">Android<sup>5</sup></a></li><li><a href="/tags/vue/" title="vue">vue<sup>2</sup></a></li><li><a href="/tags/AngularJS-01/" title="AngularJS_01">AngularJS_01<sup>1</sup></a></li><li><a href="/tags/CSS/" title="CSS">CSS<sup>1</sup></a></li><li><a href="/tags/Ionic/" title="Ionic">Ionic<sup>1</sup></a></li><li><a href="/tags/java/" title="java">java<sup>1</sup></a></li><li><a href="/tags/gulp/" title="gulp">gulp<sup>1</sup></a></li><li><a href="/tags/git/" title="git">git<sup>1</sup></a></li><li><a href="/tags/前端开发规范手册/" title="前端开发规范手册">前端开发规范手册<sup>1</sup></a></li></ul></div><div class="linkslist"><p class="asidetitle">友情链接</p><ul><li><a href="http://www.cnblogs.com/earl-yongchang/" target="_blank" title=" 以前写作博客">博客园</a></li><li><a href="http://www.infoq.com/cn/" target="_blank" title=" 促进软件开发领域知识与创新的传播">InfoQ</a></li><li><a href="https://sdk.cn/" target="_blank" title=" 中国领先的开发者服务">开发者服务</a></li><li><a href="https://www.cnblogs.com/TomXu/archive/2011/12/15/2288411.html#undefined 深入理解JavaScript系列文章" target="_blank" title="汤姆大叔">汤姆大叔</a></li></ul></div><div class="weiboshow"><p class="asidetitle">新浪微博</p><iframe width="100%" height="119" class="share_self" frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=5807798537&verifier=5fcd6856&dpc=1"></iframe></div></aside></div></div><footer><div id="footer"><div class="line"><span></span><div class="author"></div></div><section class="info"><p>Keep Calm<br>Carry On</p></section><div class="social-font" class="clearfix"><a href="http://weibo.com/5807798537" target="_blank" class="icon-weibo" title="微博"></a> <a href="https://github.com/EARL8888" target="_blank" class="icon-github" title="github"></a> <a href="mailto:z604458675@gmail.com" target="_blank" class="icon-email" title="Email Me"></a></div></div><div class="footer-text"><p class="copyright"><a href="/about" target="_blank" title="earl">earl | 农民艺术家</a> Copyright © 2019</p><span id="busuanzi_container_site_uv">本站访客数 <span id="busuanzi_value_site_uv"></span> 人次<p><a style="color:#fff" href="http://www.miitbeian.gov.cn/" target="_blank">京ICP备19006937号-1</a></p></span></div><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></footer><script src="/js/jquery-2.0.3.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><script src="/js/jquery.qrcode-0.12.0.min.js"></script><script type="text/javascript">$(document).ready(function(){$(".navbar").click(function(){$("header nav").toggleClass("shownav")});var e=0,s=$("#main"),n=$("#asidepart"),a=$(".closeaside"),o=$(".openaside");a.click(function(){n.addClass("fadeOut").css("display","none"),o.css("display","block").addClass("fadeIn"),s.addClass("moveMain")}),o.click(function(){o.css("display","none").removeClass("beforeFadeIn"),n.css("display","block").removeClass("fadeOut").addClass("fadeIn"),s.removeClass("moveMain")}),$(window).scroll(function(){o.css("top",Math.max(80,260-$(this).scrollTop()))}),$(window).resize(function(){"number"==typeof window.innerWidth?e=window.innerWidth:document.documentElement&&document.documentElement.clientWidth&&(e=document.documentElement.clientWidth),1024<=e?$("header nav").removeClass("shownav"):(s.removeClass("moveMain"),n.css("display","block").removeClass("fadeOut"),o.css("display","none"),$("#toc.toc-aside").css("display","none"))})})</script><script type="text/javascript">$(document).ready(function(){var c=$(".article-content>iframe"),n=$(".article-content>embed"),o=($("#toc"),$("#toc.toc-aside")),e=$(".openaside"),i=$(".closeaside");0<c.length&&c.wrap('<div class="video-container" />'),0<n.length&&n.wrap('<div class="video-container" />'),i.click(function(){o.css("display","block").addClass("fadeIn")}),e.click(function(){o.css("display","none")}),$(window).scroll(function(){o.css("top",Math.max(140,320-$(this).scrollTop()))})})</script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">$(document).ready(function(){$(".article-content").each(function(a){$(this).find("img").each(function(){if(!$(this).parent().hasClass("fancybox")){var a=this.alt;a&&$(this).after('<span class="caption">'+a+"</span>"),$(this).wrap('<a href="'+this.src+'" title="'+a+'" class="fancybox"></a>')}}),$(this).find(".fancybox").each(function(){$(this).attr("rel","article"+a)})}),$.fancybox&&$(".fancybox").fancybox()})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?13fd776f810bd0d42243353eab26fad6";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div id="totop"><a title="返回顶部"><img src="/img/scrollup.png"></a></div><script src="/js/totop.js"></script></body>